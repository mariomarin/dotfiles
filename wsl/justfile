# WSL NixOS Setup and Management
# This justfile helps Windows users set up and manage NixOS on WSL2

# Set default shell to nushell for cross-platform scripting
set shell := ["nu", "-c"]

# OS compatibility check - only run on Windows
_check-os:
    nu scripts/check-os.nu

# Default: show help
default:
    @just --list

# Check if WSL2 is installed
check-wsl: _check-os
    nu scripts/check-wsl.nu

# Install WSL2 (requires Administrator privileges)
install-wsl: _check-os
    nu scripts/install-wsl.nu

# Download latest NixOS-WSL tarball
download-nixos: _check-os
    nu scripts/download-nixos.nu

# Import NixOS into WSL
import-nixos: _check-os
    nu scripts/import-nixos.nu

# Start NixOS WSL instance
start-nixos: _check-os
    nu scripts/start-nixos.nu

# List installed WSL distributions
list-distros: _check-os
    nu scripts/list-distros.nu

# Set NixOS as default WSL distribution
set-default: _check-os
    nu scripts/set-default.nu

# Stop NixOS WSL instance
stop-nixos: _check-os
    nu scripts/stop-nixos.nu

# Unregister/remove NixOS from WSL
uninstall-nixos: _check-os
    nu scripts/uninstall-nixos.nu

# Run a command in NixOS WSL
run COMMAND: _check-os
    wsl -d NixOS --exec {{COMMAND}}

# Open NixOS WSL in Windows Terminal
terminal: _check-os
    nu scripts/terminal.nu

# Show WSL system information
info: _check-os
    nu scripts/info.nu

# Health check for WSL setup
health: _check-os
    nu scripts/health.nu

# Complete WSL NixOS setup (one-command install)
setup: _check-os
    nu scripts/setup.nu

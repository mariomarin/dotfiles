# Nix (macOS) - source nix-daemon before anything else
# This ensures Nix paths are available for the rest of the config
if [[ -e /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh ]]; then
  . /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh
fi

# Xorg
export XENVIRONMENT="$HOME/.Xresources"

# node
export NPM_CONFIG_PREFIX="${HOME}/.local/npm"

# workaround for: https://github.com/npm/cli/issues/4163
export NODE_OPTIONS=--dns-result-order=ipv4first

# go
export GOPATH=~/go
export GOBIN=$GOPATH/bin

# rust
export CARGOBIN=$HOME/.cargo/bin

# home and local bin
LOCALBIN=$HOME/.local/bin
HOMEBIN=$HOME/bin

# ruby
# https://wiki.archlinux.org/title/Ruby#Setup
# export GEM_HOME="$(ruby -e 'puts Gem.user_dir')"
GEM_HOME="${XDG_DATA_HOME:-$HOME/.local/share}/gem/ruby/3.0.0"

# Krew - kubectl plugin manager
export KREW_ROOT="${XDG_DATA_HOME:-$HOME/.local/share}/krew"
# kubectl plugins configuration
export KUBE_FUZZY_PREVIEW_ENABLED=true
export KUBECONFIG=~/.kube/config

# fly
export FLYCTL_INSTALL="$HOME/.fly"


# PATH
typeset -U PATH path
path=(
  "$CARGOBIN"
  "$FLYCTL_INSTALL/bin:$PATH"
  "$GOPATH/bin"
  "$HOMEBIN"
  "$KREW_ROOT/bin"
  "$LOCALBIN"
  "$NPM_CONFIG_PREFIX/bin"
  "$XDG_DATA_HOME/nvim/mason/bin"
  "$path[@]")
export PATH

# APPS
export EDITOR=nvim
export TERM=alacritty

# Editors
export VISUAL=nvim
export PAGER=less

# Language
if [[ -z "$LANG" ]]; then
  export LANG='en_US.UTF-8'
fi

# Gnome needs a location to save screenshots
export PICTURES=~/Pictures

# Zim
export ZIM_HOME="${XDG_CONFIG_HOME:-$HOME/.config}/zim"
export ZIM_CONFIG_FILE="${XDG_CONFIG_HOME:-$HOME/.config}/zim/zimrc"

# zsh-vi-mode
export ZVM_INIT_MODE=sourcing
export ZVM_VI_INSERT_ESCAPE_BINDKEY=jk
# Enable surround feature with classic mode (verb->s->surround)
export ZVM_VI_SURROUND_BINDKEY=classic
# Highlight surround objects
export ZVM_VI_HIGHLIGHT_FOREGROUND=black
export ZVM_VI_HIGHLIGHT_BACKGROUND=yellow
# Enable system clipboard integration (yank/paste with system clipboard)
export ZVM_CLIPBOARD_PROVIDER='xsel'

# podman rootless
# export DOCKER_HOST=unix://$XDG_RUNTIME_DIR/podman/podman.sock

# Docker rootless
# export DOCKER_HOST=unix://$XDG_RUNTIME_DIR/docker.sock
export DOCKER_BUILDKIT=1

# zim
: ${ZIM_HOME=${ZDOTDIR:-${HOME}}/.zim}

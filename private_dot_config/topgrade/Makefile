.PHONY: all update status force plugins system

# Default target
all: update

# Run topgrade manually
update:
	@echo "ðŸ”„ Running topgrade manually..."
	@systemctl --user start topgrade.service || topgrade --no-retry
	@echo "âœ… All updates complete"

# Show timer status
status:
	@echo "ðŸ“Š Topgrade timer status:"
	@systemctl --user status topgrade.timer --no-pager || echo "Timer not enabled"
	@echo ""
	@echo "ðŸ“… Next scheduled run:"
	@systemctl --user list-timers topgrade.timer --no-pager || true

# Force update (bypasses timer)
force:
	@echo "ðŸ”„ Force running topgrade..."
	@topgrade --no-retry
	@echo "âœ… All updates complete"

# Update only plugins
plugins:
	@echo "ðŸ”„ Updating plugins..."
	@topgrade --only tmux vim --no-retry
	@echo "âœ… Plugin updates complete"

# Update only system packages
system:
	@echo "ðŸ”„ Updating system packages..."
	@topgrade --only system nix --no-retry
	@echo "âœ… System updates complete"
#!/usr/bin/env nu
# Install nupm (Nushell Package Manager)
# This script runs when this file changes

{{- if eq .chezmoi.os "windows" }}
let nupm_home = ($env.USERPROFILE | path join '.local' 'share' 'nupm')
{{- else }}
let nupm_home = ($env.HOME | path join '.local' 'share' 'nupm')
{{- end }}
let nupm_dir = ($nupm_home | path join 'nupm')

print "ðŸ“¦ Installing nupm (Nushell Package Manager)..."

# Create nupm home if it doesn't exist
mkdir $nupm_home

# Clone or update nupm
if ($nupm_dir | path exists) {
    print "  Updating existing nupm installation..."
    cd $nupm_dir
    git pull
} else {
    print "  Cloning nupm repository..."
    git clone https://github.com/nushell/nupm.git $nupm_dir
}

print "âœ… nupm installed successfully"
print $"   Location: ($nupm_dir)"
print ""
print "To use nupm, add this to your config.nu:"
print "  use nupm"

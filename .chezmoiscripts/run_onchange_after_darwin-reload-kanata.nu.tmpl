{{- if eq .chezmoi.os "darwin" -}}
#!/usr/bin/env nu
# Reload kanata when config changes (macOS)
# darwin.kbd hash: {{ include "private_dot_config/kanata/darwin.kbd" | sha256sum }}

def service-exists [] {
    (do { sudo launchctl list | grep "org.nixos.kanata" } | complete).exit_code == 0
}

if not (service-exists) {
    print "Kanata service not found, skipping"
    exit 0
}

print "Reloading kanata..."
sudo launchctl stop org.nixos.kanata
sleep 1sec
sudo launchctl start org.nixos.kanata
print "âœ“ Kanata reloaded"
{{- end }}

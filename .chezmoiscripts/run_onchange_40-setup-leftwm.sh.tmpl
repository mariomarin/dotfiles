#!/usr/bin/env bash
# Setup LeftWM theme and enable services

set -euo pipefail

{{- if .machineConfig.features.desktop }}
echo "Setting up LeftWM custom theme..."

# Create symlink to custom theme
if [ -L "$HOME/.config/leftwm/themes/current" ]; then
    rm "$HOME/.config/leftwm/themes/current"
fi
ln -s "$HOME/.config/leftwm/themes/custom" "$HOME/.config/leftwm/themes/current"

# Reload systemd user daemon to pick up new units
systemctl --user daemon-reload

# Enable (but don't start) the services
systemctl --user enable picom.service
systemctl --user enable polybar.service

echo "✓ LeftWM theme set to 'custom'"
echo "✓ Picom and Polybar services enabled"
echo "  - Services will start when LeftWM theme is loaded"
echo "  - Check status: systemctl --user status picom polybar"
{{- else }}
echo "Skipping LeftWM setup on non-desktop machine"
{{- end }}
#!/usr/bin/env nu
# Install container-use from source
# This script runs when the containerUse version in .chezmoidata.toml changes

let container_use_version = "{{ .versions.containerUse }}"

print $"Installing container-use@($container_use_version) from source..."

# Use go install to build and install the binary
go install $"github.com/dagger/container-use/cmd/container-use@($container_use_version)"

print "container-use installed successfully"

# Verify installation using full path
let go_bin = $"($env.HOME)/go/bin"
with-env {PATH: ($env.PATH | prepend $go_bin)} {
    container-use version | ignore
}

#!/usr/bin/env nu
# Install packages from .chezmoidata/packages.yaml (macOS)
# This script runs when the package list or script content changes

print "ğŸ“¦ Installing packages for macOS..."

# Check if homebrew is installed
if (which brew | is-empty) {
    print "âŒ Homebrew not found. Please install: https://brew.sh"
    exit 1
}

# Install brews
{{- range .packages.darwin.brews }}
if (brew list {{ . }} | complete | get exit_code) != 0 {
    print $"  Installing {{ . }}..."
    brew install {{ . }}
} else {
    print "  âœ“ {{ . }} already installed"
}
{{- end }}

# Install casks
{{- range .packages.darwin.casks }}
if (brew list --cask {{ . }} | complete | get exit_code) != 0 {
    print $"  Installing {{ . }} (cask)..."
    brew install --cask {{ . }}
} else {
    print "  âœ“ {{ . }} already installed"
}
{{- end }}

print "âœ… Packages installed successfully"
